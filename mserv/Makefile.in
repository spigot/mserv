
prefix = @prefix@
exec_prefix = @exec_prefix@
program_prefix = @program_prefix@
BINDIR = @bindir@
MANDIR = @mandir@
SHAREDIR = @datadir@/mserv
IBINDIR = ${program_prefix}${BINDIR}
IMANDIR = ${program_prefix}${MANDIR}
ISHAREDIR = ${program_prefix}${SHAREDIR}

CC = @CC@
LDFLAGS = @LDFLAGS@
CFLAGS = @CFLAGS@ -DBINDIR=\"${BINDIR}\" -DMANDIR=\"${MANDIR}\" \
         -DSHAREDIR=\"${SHAREDIR}\"
LIBS = @LIBS@
XTRA_LIBS = @XTRA_LIBS@
DEPFLAGS = @DEPFLAGS@

SRCS1 = mserv.c misc.c cmd.c acl.c mp3info.c conf.c defconf.c opt.c filter.c
OBJS1 = mserv.o misc.o cmd.o acl.o mp3info.o conf.o defconf.o opt.o filter.o

SRCS2 = mservplay.c misc.c
OBJS2 = mservplay.o misc.o

default:	mservplay mserv
		@echo "### All compiled."

install:	default
		@INSTALL@ -d -m 0755 ${IBINDIR}
		@INSTALL@ -d -m 0755 ${IMANDIR}/man1
		@INSTALL@ -d -m 0755 ${ISHAREDIR}
		@INSTALL@ -s -m 0711 mserv ${IBINDIR}/mserv
		@INSTALL@ -m 0755 mservedit ${IBINDIR}/mservedit
		@INSTALL@ -m 0644 mserv.1 ${IMANDIR}/man1/mserv.1
		@INSTALL@ -m 0644 english.lang ${ISHAREDIR}/english.lang
		@echo "### All installed."

mservplay:	${OBJS2}
		@echo "### Linking mservplay..."
		@${CC} -o mservplay ${OBJS2} ${LDFLAGS} ${XTRA_LIBS} ${LIBS}

mserv:		${OBJS1}
		@echo "### Linking mserv..."
		@${CC} -o mserv ${OBJS1} ${LDFLAGS} ${XTRA_LIBS} ${LIBS}

depend:		
		@makedepend ${SRCS1} ${DEPFLAGS}

clean:		
		rm -f *.o *~ \#* mserv mservplay config.cache config.log Makefile config.h config.status core
		rm -rf autom4te.cache

cleaner:	clean
		rm -f configure
		autoconf

.c.o:
		@echo "### Compiling $<..."
		${CC} ${CFLAGS} ${DEFS} $< -o $@

# DO NOT DELETE THIS LINE -- make depend depends on it
